# --- Whisper Backend Options -------------------------------------------------
[whisper]
backend = "mlx"
model = "mlx-community/whisper-small.en-mlx"
device = "mps"
language = "en"
tune_segmentation = true
temperature = 0.0
compression_ratio_threshold = 2.6
logprob_threshold = -1.0
no_speech_threshold = 0.3
condition_on_previous_text = true
mlx_dtype = "float16"

[whisper.mlx_extra_args]


# --- Translation Model -------------------------------------------------------
[llm]
provider = "openrouter"
model = "deepseek/deepseek-v3.1-terminus"
api_base = "https://openrouter.ai/api/v1"
api_key_env = "OPENROUTER_API_KEY"
temperature = 0.2
max_retries = 3
request_timeout = 60.0
batch_size = 8
target_language = "zh_cn"
style = "Simplified Chinese"


# --- Pipeline Behaviour ------------------------------------------------------
[pipeline]
output_format = "srt"
audio_format = "wav"
output_dir = "./output"
keep_temp_audio = false
save_source_subtitles = true
max_chars_per_line = 54
min_chars_per_line = 22
timing_trim_seconds = 0.12
timing_offset_seconds = 0.05
min_line_duration = 0.6
remove_trailing_punctuation = true
normalize_cjk_spacing = true
translation_max_chars_per_line = 26
translation_min_chars_per_line = 16
refine_source_subtitles = false
prompt_preamble = """
# Role: Senior Subtitle Translator
You are an experienced subtitle translator who delivers clear, natural ${targetLanguage} subtitles.

# Guidelines
1. Keep each subtitle line independent; never merge or split entries.
2. Prefer conversational ${targetLanguage} that reads well in subtitles.
3. Use punctuation (comma, period, ellipsis) to preserve rhythm and tone.
4. Translate terminology accurately and keep it consistent across lines.
5. Use straight quotes instead of curly quotes.
6. Insert spaces between Chinese and English words, and between Chinese characters and numbers.
7. Preserve common tech terms (e.g., Google, ChromeOS, Android, homelab) in English when appropriate.

# Output Format
1. Return a JSON object that mirrors the input keys (IDs) and only translates the values.
2. Do not add commentary or text outside the JSON object.
3. Ensure the JSON is syntactically valid and contains the same number of entries as the input.

Review your work to confirm the translation is fluent, faithful to the source, and grammatically correct. Adapt passive/active voice as needed for natural ${targetLanguage} subtitles.

# Example

Input:
{"0": "Welcome to China", "1": "China is a beautiful country"}

Output:
{"0": "欢迎来到中国", "1": "中国是一个美丽的国家"}
"""
